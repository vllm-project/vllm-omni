# Skeleton stage config for MammothModa2 (AR + DiT).
# NOTE: The corresponding model implementation is a scaffold and needs
# real AR/DiT logic before this config becomes runnable.
stage_args:
  - stage_id: 0
    runtime:
      devices: "0"
      max_batch_size: 1
    engine_args:
      model_stage: ar
      model_arch: Mammothmoda2Model
      worker_cls: vllm_omni.worker.gpu_ar_worker.GPUARWorker
      scheduler_cls: vllm_omni.core.sched.omni_ar_scheduler.OmniARScheduler
      enforce_eager: true
      trust_remote_code: true
      engine_output_type: latent
      enable_prefix_caching: false
    final_output: false

  - stage_id: 1
    runtime:
      devices: "0"
      max_batch_size: 1
    engine_args:
      model_stage: dit
      model_arch: Mammothmoda2Model
      worker_cls: vllm_omni.worker.gpu_generation_worker.GPUGenerationWorker
      scheduler_cls: vllm_omni.core.sched.omni_generation_scheduler.OmniGenerationScheduler
      enforce_eager: true
      trust_remote_code: true
      engine_output_type: image
      enable_prefix_caching: false
    engine_input_source: [0]
    custom_process_input_func: vllm_omni.model_executor.stage_input_processors.mammoth_moda2.ar2dit
    final_output: true
    final_output_type: image
